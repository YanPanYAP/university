## Лабораторная 8‑10. Руководство по демонстрации

### 1. Назначение
Комплекс иллюстрирует работу многопоточного сервера с динамически подключаемыми службами (`Service_Library`) и клиентскими приложениями (`Client`, `RemoteConsole`). Основные сервисы:
- `Rand` — выдаёт случайное число.
- `Time` — возвращает текущее время сервера.
- `Echo` — отсылает клиенту его же сообщение.

### 2. Состав проектов
| Проект | Назначение |
| --- | --- |
| `ConcurrentServer` | TCP‑сервер, распределяет клиентов между сервисами, следит за тайм‑аутами. |
| `Service_Library` | DLL с потоковыми функциями `RandServer`, `TimeServer`, `EchoServer`. |
| `Client` | Интерфейс пользователя для выбора сервиса и диалога. |
| `RemoteConsole` | Удалённая консоль управления (старт/стоп, статистика). |

### 3. Сборка
1. Открыть `SH_Laba_8_10/ConcurrentServer.sln` в Visual Studio.
2. Настроить конфигурацию `Debug x86` (или ту, с которой работали ранее).
3. Собрать решение (`Build → Build Solution`). Убедиться, что в `SH_Laba_8_10/Debug` появились `ConcurrentServer.exe`, `Client.exe`, `RemoteConsole.exe`, `Service_Library.dll`.

### 4. Подготовка к демонстрации
1. **Сервер**: запустить `ConcurrentServer.exe`. В консоли будет видно старт потоков и сообщения о тайм‑аутах.
2. **Удалённая консоль (опционально)**: `RemoteConsole.exe` позволяет отправлять команды (`START`, `STOP`, `STATISTICS`). Это удобно, если нужно показать управление очередью подключений.
3. **Клиент**: `Client.exe` используется для всех трёх сервисов. Перед запуском убедиться, что сервер слушает нужный порт.

### 5. Пошаговая демонстрация возможностей
#### 5.1 Подключение клиента
1. Запустить `Client.exe`.
2. Выбрать тип подключения:
   - *1* — по имени хоста (`gethostbyname`).
   - *2* — по позывному через широковещательный UDP‑поиск.
3. Ввести порт сервера.
4. Выбрать сервис: `Rand`, `Time` или `Echo`.
5. Дождаться подтверждения (`Call` = `rCall`).

#### 5.2 Работа с сервисами
В клиенте используется шаговый ввод: пользователь печатает команду → получает одно ответное сообщение → при необходимости вводит следующую команду. Сообщение сервисов приходит один раз, после чего клиент снова ждёт ввода (требование текущей задачи выполнено).

- **Rand**  
  1. Ввести `Rand`.  
  2. Получить строку вида `Rand: <число>`.  
  3. Ввести `exit`, чтобы завершить соединение.

- **Time**  
  1. Ввести `Time`.  
  2. Ответ: `Time dd.mm.yyyy/hh:mm:ss`.  
  3. Любой другой ввод (`exit`) закрывает сеанс.

- **Echo**  
  1. Ввести произвольную строку (например, `Hello`).  
  2. Получить тот же текст от сервера.  
  3. Команда `exit` закрывает соединение.

При бездействии более заданного тайм‑аута сервер отправит `Close: timeout;` и завершит поток.

#### 5.3 Мониторинг состояния
- Консоль `ConcurrentServer` показывает:
  - старт и остановку потоков (`ASStartMessage`, `ASFinishMessage`);
  - сообщения тайм‑аутов (`ASWTimer`).
- `RemoteConsole` может запросить статистику (`STATISTICS`), остановить выдачу новых подключений (`STOP`) или возобновить (`START`).

### 6. Отладка и проверки
1. **Один клиент/один сервис** — базовый сценарий.
2. **Несколько клиентов** — убедиться, что каждая служба обрабатывается в своём потоке, сообщения не дублируются.
3. **Тайм‑аут** — оставить клиента без ввода дольше минуты и дождаться `Close: timeout;`.
4. **Аварийные случаи** — отключить клиента (Ctrl+C) и проверить, что сервер помечает поток как `ABORT`.

### 7. Советы по демонстрации
- Показать различие между командами, завершением по `exit` и завершением по тайм‑ауту.
- Для `Rand` можно сравнить несколько вызовов подряд: каждое число будет новым, поскольку генератор пересеивается текущим временем.
- В `Echo` удобно демонстрировать поддержку произвольных строк.
- С `RemoteConsole`: во время активных клиентов отправить `STATISTICS`, чтобы увидеть счётчики `Accept`, `Finished`, `ClientServiceNumber`.

### 8. Очистка
После демонстрации закрыть клиент, сервер и удалённую консоль. При необходимости удалить временные файлы сборки через стандартные средства Visual Studio.






